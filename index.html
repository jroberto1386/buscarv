<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía Interactiva de BUSCARV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: Se ha diseñado una aplicación de página única con navegación por pestañas (Inicio, Fundamentos, Aplicaciones, Potenciando, Alternativas). Esta estructura segmenta la información compleja en bloques manejables, permitiendo al usuario explorar de forma no lineal. En lugar de leer pasivamente, el usuario interactúa con simulaciones de hojas de cálculo, selectores dinámicos y visualizaciones de datos. El objetivo es facilitar el aprendizaje práctico y la retención, transformando un informe denso en una herramienta de aprendizaje atractiva y eficiente. La navegación es intuitiva y el flujo guía al usuario desde lo básico hasta lo más avanzado de forma natural. -->
    <!-- Visualization & Content Choices: 
        1. Fundamentos -> Sintaxis Interactiva (HTML/CSS/JS): Se usa para desglosar la fórmula. El objetivo es informar. Al pasar el cursor, el usuario obtiene explicaciones de cada argumento. Es más efectivo que un bloque de texto estático.
        2. Aplicaciones -> Simuladores de Tablas (HTML/JS): Se utilizan para mostrar casos de uso prácticos. El objetivo es organizar y demostrar. El usuario selecciona un ID y ve cómo BUSCARV rellena datos, imitando la experiencia real en Excel para un aprendizaje más profundo.
        3. Potenciando BUSCARV -> Demostraciones Dinámicas (HTML/JS): Para ilustrar la sinergia con otras funciones. El objetivo es demostrar relaciones. Por ejemplo, en la demo de BUSCARV+COINCIDIR, el usuario puede cambiar tanto la fila como la columna a buscar, viendo la fórmula actualizarse en tiempo real.
        4. Alternativas -> Gráfico de Barras Comparativo (Chart.js/Canvas): Para comparar el rendimiento. El objetivo es comparar. Un gráfico de barras visualiza la diferencia de eficiencia entre BUSCARV, ÍNDICE+COINCIDIR y BUSCARX de manera más impactante que el texto solo, justificando el cambio a funciones más modernas.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4B4B4B;
        }
        .tab-active {
            border-bottom-color: #D97706;
            color: #D97706;
            font-weight: 600;
        }
        .tab-inactive {
            border-bottom-color: transparent;
            color: #78716C;
        }
        .formula-arg {
            cursor: pointer;
            position: relative;
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .formula-arg .tooltip-text {
            visibility: hidden;
            width: 280px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            line-height: 1.4;
        }
        .formula-arg:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .table-cell {
            padding: 8px 12px;
            border: 1px solid #E7E5E4;
            text-align: left;
            font-size: 0.875rem;
        }
        .table-header {
            background-color: #F5F5F4;
            font-weight: 600;
        }
        .interactive-table select, .interactive-table input {
            border: 1px solid #D6D3D1;
            border-radius: 4px;
            padding: 4px 8px;
            width: 100%;
        }
        .code-block {
            background-color: #1E293B;
            color: #E2E8F0;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .highlight-row {
            background-color: #FEF3C7; /* amber-100 */
            transition: background-color 0.3s ease-in-out;
        }
        .content-section {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-hover {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="antialiased">

    <div class="min-h-screen">
        <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8 text-amber-700" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"/></svg>
                        <h1 class="text-2xl font-bold text-amber-700">Guía Maestra de BUSCARV</h1>
                    </div>
                    <nav class="hidden md:flex space-x-6">
                        <button data-tab="inicio" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-active">Inicio</button>
                        <button data-tab="fundamentos" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Fundamentos</button>
                        <button data-tab="aplicaciones" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Aplicaciones</button>
                        <button data-tab="potenciando" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Potenciando</button>
                        <button data-tab="alternativas" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Alternativas</button>
                    </nav>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
            
            <section id="inicio" class="content-section">
                <div class="text-center bg-amber-50 border border-amber-200 rounded-lg p-8">
                    <h2 class="text-3xl font-bold text-amber-800 mb-3">Domina la Función Clave de Búsqueda de Excel</h2>
                    <p class="text-lg text-stone-700 max-w-3xl mx-auto">
                        Bienvenido a esta guía interactiva sobre BUSCARV (VLOOKUP). Aquí desmitificaremos una de las funciones más potentes y utilizadas de Excel. Aprenderás desde su sintaxis básica hasta cómo combinarla con otras fórmulas para resolver problemas complejos, y descubrirás por qué sus sucesores, como BUSCARX, están cambiando el juego.
                    </p>
                </div>

                <div class="mt-12 grid md:grid-cols-3 gap-8 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 card-hover">
                        <div class="flex justify-center items-center mb-4 text-amber-600">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"/></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-stone-800 mb-2">¿Qué es BUSCARV?</h3>
                        <p class="text-stone-600">Es una función de búsqueda vertical que te permite encontrar un valor específico en la primera columna de una tabla y devolver un dato correspondiente de otra columna en la misma fila.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 card-hover">
                        <div class="flex justify-center items-center mb-4 text-amber-600">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-stone-800 mb-2">¿Por qué es importante?</h3>
                        <p class="text-stone-600">Es la herramienta fundamental para cruzar y consolidar información entre distintas tablas, una tarea esencial en cualquier análisis de datos, desde finanzas hasta logística.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 card-hover">
                        <div class="flex justify-center items-center mb-4 text-amber-600">
                            <svg class="w-12 h-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon"><path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/></svg>
                        </div>
                        <h3 class="text-xl font-semibold text-stone-800 mb-2">¿Qué aprenderás aquí?</h3>
                        <p class="text-stone-600">No solo a usar BUSCARV, sino a entender su lógica, sus limitaciones y cómo las funciones modernas como BUSCARX superan sus debilidades, preparándote para el futuro de Excel.</p>
                    </div>
                </div>
            </section>

            <section id="fundamentos" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Fundamentos de BUSCARV</h2>
                <p class="text-lg text-stone-600 mb-8">Para dominar BUSCARV, primero debemos entender sus cuatro componentes esenciales. Interactúa con la fórmula a continuación para ver qué hace cada argumento.</p>
                
                <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 mb-8">
                    <h3 class="text-xl font-semibold text-center mb-4">Sintaxis Interactiva</h3>
                    <div class="code-block text-center text-lg">
                        =BUSCARV(<span class="formula-arg bg-sky-200 text-sky-800">valor_buscado<span class="tooltip-text"><b>¿Qué quieres buscar?</b> Es el valor (ej. ID de producto "PROD-002") que sirve como identificador único. Debe estar en la primera columna de tu tabla de datos.</span></span>, <span class="formula-arg bg-emerald-200 text-emerald-800">matriz_tabla<span class="tooltip-text"><b>¿Dónde quieres buscar?</b> Es el rango de celdas (ej. A2:D100) que contiene los datos. La primera columna DEBE ser la que contiene el 'valor_buscado'.</span></span>, <span class="formula-arg bg-purple-200 text-purple-800">indicador_columnas<span class="tooltip-text"><b>¿Qué columna quieres devolver?</b> Es el número de la columna dentro de tu 'matriz_tabla' de la cual quieres obtener el resultado. La primera columna es 1, la segunda 2, etc.</span></span>, <span class="formula-arg bg-rose-200 text-rose-800">rango<span class="tooltip-text"><b>¿Búsqueda exacta o aproximada?</b> Usa FALSO (o 0) para una coincidencia exacta (lo más común y seguro). Usa VERDADERO (o 1) para una coincidencia aproximada (útil para rangos, como escalas de comisiones).</span></span>)
                    </div>
                </div>

                <h3 class="text-2xl font-semibold text-stone-800 mb-4">Búsqueda Exacta vs. Aproximada</h3>
                <p class="text-stone-600 mb-6">La elección del cuarto argumento, `rango`, es crucial y cambia completamente el comportamiento de la función. La búsqueda exacta (FALSO) es la opción predeterminada para el 95% de los casos.</p>

                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <h4 class="text-xl font-semibold text-rose-700 mb-3">Búsqueda Exacta (FALSO / 0)</h4>
                        <p class="mb-4">Busca una coincidencia idéntica del `valor_buscado`. Si no la encuentra, devuelve un error #N/A. Es la opción ideal para buscar IDs, códigos de producto, DNI, etc., donde no hay lugar para ambigüedad.</p>
                        <p class="font-semibold mb-2">Ejemplo: Buscar el precio de un producto específico.</p>
                        <table class="w-full border-collapse">
                            <thead><tr><th class="table-cell table-header">ID_Producto</th><th class="table-cell table-header">Precio</th></tr></thead>
                            <tbody>
                                <tr><td class="table-cell">PROD-001</td><td class="table-cell">$150</td></tr>
                                <tr><td class="table-cell bg-sky-100">PROD-002</td><td class="table-cell bg-emerald-100">$200</td></tr>
                                <tr><td class="table-cell">PROD-003</td><td class="table-cell">$250</td></tr>
                            </tbody>
                        </table>
                        <div class="code-block mt-4 text-sm">=BUSCARV("PROD-002", A2:B4, 2, FALSO)
                        <br><span class="text-emerald-400 font-bold">--> Devuelve: $200</span></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <h4 class="text-xl font-semibold text-teal-700 mb-3">Búsqueda Aproximada (VERDADERO / 1)</h4>
                        <p class="mb-4">Busca la coincidencia más cercana que sea menor o igual al `valor_buscado`. <strong>¡Crítico!</strong> La primera columna de la tabla debe estar ordenada de forma ascendente.</p>
                        <p class="font-semibold mb-2">Ejemplo: Asignar una comisión según el volumen de ventas.</p>
                         <table class="w-full border-collapse">
                            <thead><tr><th class="table-cell table-header">Ventas Mínimas</th><th class="table-cell table-header">Comisión</th></tr></thead>
                            <tbody>
                                <tr><td class="table-cell">$0</td><td class="table-cell">1%</td></tr>
                                <tr><td class="table-cell bg-sky-100">$5,000</td><td class="table-cell bg-emerald-100">3%</td></tr>
                                <tr><td class="table-cell">$10,000</td><td class="table-cell">5%</td></tr>
                            </tbody>
                        </table>
                        <div class="code-block mt-4 text-sm">=BUSCARV(7800, A2:B4, 2, VERDADERO)
                        <br><span class="text-emerald-400 font-bold">--> Devuelve: 3% (porque 7800 es mayor que 5000 pero menor que 10000)</span></div>
                    </div>
                </div>
            </section>

            <section id="aplicaciones" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Aplicaciones Prácticas</h2>
                <p class="text-lg text-stone-600 mb-8">BUSCARV es una navaja suiza. Aquí te mostramos sus usos más comunes a través de ejemplos interactivos. Selecciona un valor para ver la magia.</p>
                
                <div class="space-y-8">
                    <!-- Cruce de Datos -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">1. Cruzar y Combinar Datos de Tablas</h3>
                        <p class="mb-4">El uso más clásico: tienes una tabla de ventas con ID de Empleado, pero necesitas traer el nombre del empleado desde otra tabla.</p>
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h4 class="font-semibold mb-2">Tabla de Ventas</h4>
                                <table class="w-full border-collapse">
                                    <thead><tr><th class="table-cell table-header">ID_Venta</th><th class="table-cell table-header">ID_Empleado</th><th class="table-cell table-header">Monto</th></tr></thead>
                                    <tbody>
                                        <tr><td class="table-cell">101</td><td class="table-cell">EMP-02</td><td class="table-cell">$500</td></tr>
                                        <tr><td class="table-cell">102</td><td class="table-cell">EMP-03</td><td class="table-cell">$1200</td></tr>
                                        <tr><td class="table-cell">103</td><td class="table-cell">EMP-01</td><td class="table-cell">$850</td></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">Tabla de Empleados (Matriz de Búsqueda)</h4>
                                <table class="w-full border-collapse">
                                    <thead><tr><th class="table-cell table-header">ID_Empleado</th><th class="table-cell table-header">Nombre</th></tr></thead>
                                    <tbody id="tabla-empleados-body">
                                        <tr id="emp-row-EMP-01"><td class="table-cell">EMP-01</td><td class="table-cell">Ana Torres</td></tr>
                                        <tr id="emp-row-EMP-02"><td class="table-cell">EMP-02</td><td class="table-cell">Luis Gómez</td></tr>
                                        <tr id="emp-row-EMP-03"><td class="table-cell">EMP-03</td><td class="table-cell">Carla Díaz</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="mt-6 p-4 bg-stone-50 rounded-md border">
                            <h4 class="font-semibold mb-2">Simulador Interactivo</h4>
                            <label for="cruce-selector" class="block text-sm font-medium text-stone-700">Selecciona un ID de Empleado de la tabla de ventas:</label>
                            <select id="cruce-selector" class="mt-1">
                                <option value="EMP-02">EMP-02</option>
                                <option value="EMP-03">EMP-03</option>
                                <option value="EMP-01">EMP-01</option>
                            </select>
                            <div class="mt-4">
                                <p><strong>Nombre del Empleado:</strong> <span id="cruce-resultado" class="font-bold text-lg text-emerald-600">Luis Gómez</span></p>
                                <div class="code-block mt-2 text-sm" id="cruce-formula">=BUSCARV("EMP-02", [Tabla Empleados], 2, FALSO)</div>
                            </div>
                        </div>
                    </div>

                    <!-- Rellenar Plantillas -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">2. Rellenar Formularios y Plantillas Dinámicas</h3>
                        <p class="mb-4">Crea plantillas de facturas o informes que se autocompletan. Al introducir un ID de Cliente, BUSCARV rellena el resto de los datos.</p>
                         <div class="grid md:grid-cols-2 gap-8 items-start">
                             <div>
                                <h4 class="font-semibold mb-2">Factura (Plantilla)</h4>
                                <div class="p-4 border rounded-md">
                                    <label for="factura-selector">ID Cliente:</label>
                                    <select id="factura-selector" class="mt-1 w-full">
                                        <option value="CLI-101">CLI-101</option>
                                        <option value="CLI-102">CLI-102</option>
                                        <option value="CLI-103">CLI-103</option>
                                    </select>
                                    <p class="mt-2"><strong>Nombre:</strong> <span id="factura-nombre" class="font-semibold">Global Corp</span></p>
                                    <p class="mt-1"><strong>Dirección:</strong> <span id="factura-direccion" class="font-semibold">Av. Principal 123</span></p>
                                    <p class="mt-1"><strong>Teléfono:</strong> <span id="factura-telefono" class="font-semibold">555-1234</span></p>
                                </div>
                            </div>
                             <div>
                                <h4 class="font-semibold mb-2">Base de Datos de Clientes</h4>
                                <table class="w-full border-collapse">
                                    <thead><tr><th class="table-cell table-header">ID</th><th class="table-cell table-header">Nombre</th><th class="table-cell table-header">Dirección</th><th class="table-cell table-header">Teléfono</th></tr></thead>
                                    <tbody>
                                        <tr><td class="table-cell">CLI-101</td><td class="table-cell">Global Corp</td><td class="table-cell">Av. Principal 123</td><td class="table-cell">555-1234</td></tr>
                                        <tr><td class="table-cell">CLI-102</td><td class="table-cell">Innova S.A.</td><td class="table-cell">Calle Falsa 456</td><td class="table-cell">555-5678</td></tr>
                                        <tr><td class="table-cell">CLI-103</td><td class="table-cell">Mercadeo Veloz</td><td class="table-cell">Paseo del Sol 789</td><td class="table-cell">555-9012</td></tr>
                                    </tbody>
                                </table>
                             </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="potenciando" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Potenciando a BUSCARV</h2>
                <p class="text-lg text-stone-600 mb-8">BUSCARV brilla de verdad cuando se combina con otras funciones. Estas sinergias resuelven sus debilidades y lo hacen mucho más robusto.</p>

                <div class="space-y-8">
                    <!-- BUSCARV + COINCIDIR -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">BUSCARV + COINCIDIR: La Búsqueda Dinámica</h3>
                        <p class="mb-4">Esta es la combinación estrella. Anidamos `COINCIDIR` en el `indicador_columnas` para que el número de columna se calcule automáticamente según su encabezado. Tu fórmula ya no se romperá si insertas o reordenas columnas.</p>
                        
                        <h4 class="font-semibold mb-2">Tabla de Datos de Productos</h4>
                        <table class="w-full border-collapse" id="pot-match-table">
                            <thead><tr><th class="table-cell table-header">SKU</th><th class="table-cell table-header">Producto</th><th class="table-cell table-header">Precio</th><th class="table-cell table-header">Stock</th></tr></thead>
                            <tbody>
                                <tr><td class="table-cell">A-001</td><td class="table-cell">Laptop</td><td class="table-cell">$1200</td><td class="table-cell">50</td></tr>
                                <tr><td class="table-cell">A-002</td><td class="table-cell">Monitor</td><td class="table-cell">$300</td><td class="table-cell">120</td></tr>
                                <tr><td class="table-cell">A-003</td><td class="table-cell">Teclado</td><td class="table-cell">$75</td><td class="table-cell">200</td></tr>
                            </tbody>
                        </table>

                        <div class="mt-6 p-4 bg-stone-50 rounded-md border grid md:grid-cols-2 gap-4">
                            <div>
                                <label for="pot-sku-selector" class="block text-sm font-medium">Buscar SKU:</label>
                                <select id="pot-sku-selector" class="mt-1">
                                    <option value="A-001">A-001</option>
                                    <option value="A-002" selected>A-002</option>
                                    <option value="A-003">A-003</option>
                                </select>
                            </div>
                            <div>
                                <label for="pot-col-selector" class="block text-sm font-medium">Obtener dato de la columna:</label>
                                <select id="pot-col-selector" class="mt-1">
                                    <option value="Producto">Producto</option>
                                    <option value="Precio">Precio</option>
                                    <option value="Stock" selected>Stock</option>
                                </select>
                            </div>
                        </div>
                         <div class="mt-4">
                            <p><strong>Resultado:</strong> <span id="pot-match-resultado" class="font-bold text-lg text-emerald-600">120</span></p>
                            <div class="code-block mt-2 text-sm" id="pot-match-formula">=BUSCARV("A-002", A2:D4, COINCIDIR("Stock", A1:D1, 0), FALSO)</div>
                        </div>
                    </div>
                    <!-- BUSCARV + SI.ERROR -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">BUSCARV + SI.ERROR: Manejo Profesional de Errores</h3>
                        <p class="mb-4">Cuando BUSCARV no encuentra un valor, devuelve el antiestético error #N/A. Envolvemos la fórmula con `SI.ERROR` para reemplazarlo por un mensaje personalizado, como "No Encontrado", 0, o una celda en blanco.</p>

                        <div class="mt-6 p-4 bg-stone-50 rounded-md border">
                            <label for="pot-error-input" class="block text-sm font-medium">Introduce un SKU para buscar (prueba con "A-001" o "A-999"):</label>
                            <input type="text" id="pot-error-input" value="A-999" class="mt-1">
                            
                            <div class="mt-4">
                                <p><strong>Stock del producto:</strong> <span id="pot-error-resultado" class="font-bold text-lg text-rose-600">Producto no encontrado</span></p>
                                <div class="code-block mt-2 text-sm" id="pot-error-formula">=SI.ERROR(BUSCARV("A-999", A2:D4, 4, FALSO), "Producto no encontrado")</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="alternativas" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Limitaciones y Alternativas Modernas</h2>
                <p class="text-lg text-stone-600 mb-8">A pesar de su utilidad, BUSCARV tiene debilidades importantes. Conoce por qué los expertos prefieren alternativas más flexibles y potentes como ÍNDICE+COINCIDIR y el revolucionario BUSCARX.</p>

                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">Debilidades Clave de BUSCARV</h3>
                        <ul class="space-y-3 list-disc list-inside text-stone-700">
                            <li>
                                <strong class="text-rose-700">No busca a la izquierda:</strong> Solo puede buscar en la primera columna de la tabla y devolver un valor de una columna a su derecha. Un gran limitante.
                            </li>
                            <li>
                                <strong class="text-rose-700">Es frágil:</strong> Si no se usa con `COINCIDIR`, la fórmula se rompe si se insertan o eliminan columnas en la tabla de origen, ya que el índice de columna se vuelve incorrecto.
                            </li>
                            <li>
                                <strong class="text-rose-700">Rendimiento:</strong> En tablas con cientos de miles de filas, puede volverse lento, ya que evalúa la tabla completa en memoria.
                            </li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                         <h3 class="text-xl font-semibold text-stone-800 mb-4">Comparativa de Rendimiento</h3>
                         <p class="text-sm text-stone-600 mb-4">Este gráfico ilustra el tiempo de cálculo relativo en un gran conjunto de datos. Menor es mejor.</p>
                         <div class="chart-container" style="position: relative; height:200px; width:100%">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="mt-10 bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                    <h3 class="text-2xl font-semibold text-center text-stone-800 mb-6">Tabla Comparativa de Funciones de Búsqueda</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full min-w-[600px] border-collapse">
                            <thead>
                                <tr>
                                    <th class="table-cell table-header">Característica</th>
                                    <th class="table-cell table-header text-center">BUSCARV</th>
                                    <th class="table-cell table-header text-center bg-amber-100">ÍNDICE + COINCIDIR</th>
                                    <th class="table-cell table-header text-center bg-emerald-100">BUSCARX</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-cell font-semibold">Busca a la izquierda</td>
                                    <td class="table-cell text-center"><svg class="w-7 h-7 inline-block text-rose-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></td>
                                    <td class="table-cell text-center bg-amber-50"><svg class="w-7 h-7 inline-block text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/></svg></td>
                                    <td class="table-cell text-center bg-emerald-50"><svg class="w-7 h-7 inline-block text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/></svg></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Robusto ante cambios de columnas</td>
                                    <td class="table-cell text-center"><svg class="w-7 h-7 inline-block text-amber-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"/></svg></td>
                                    <td class="table-cell text-center bg-amber-50"><svg class="w-7 h-7 inline-block text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/></svg></td>
                                    <td class="table-cell text-center bg-emerald-50"><svg class="w-7 h-7 inline-block text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/></svg></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Manejo de errores nativo</td>
                                    <td class="table-cell text-center"><svg class="w-7 h-7 inline-block text-rose-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></td>
                                    <td class="table-cell text-center bg-amber-50"><svg class="w-7 h-7 inline-block text-rose-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></td>
                                    <td class="table-cell text-center bg-emerald-50"><svg class="w-7 h-7 inline-block text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/></svg></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Búsqueda inversa (de abajo hacia arriba)</td>
                                    <td class="table-cell text-center"><svg class="w-7 h-7 inline-block text-rose-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></td>
                                    <td class="table-cell text-center bg-amber-50"><svg class="w-7 h-7 inline-block text-rose-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></td>
                                    <td class="table-cell text-center bg-emerald-50"><svg class="w-7 h-7 inline-block text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/></svg></td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Facilidad de uso / Sintaxis</td>
                                    <td class="table-cell text-center">Moderada</td>
                                    <td class="table-cell text-center bg-amber-50">Compleja (dos funciones)</td>
                                    <td class="table-cell text-center bg-emerald-50">Sencilla y potente</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-6 p-4 bg-emerald-50 border border-emerald-200 rounded-md text-center">
                        <p class="font-semibold text-emerald-800">Conclusión: Si tu versión de Excel lo soporta (Microsoft 365, Excel 2021), <strong class="text-xl">BUSCARX es la opción superior en todos los aspectos.</strong> Es más potente, más flexible y más fácil de escribir que BUSCARV y ÍNDICE+COINCIDIR.</p>
                    </div>
                </div>

            </section>
        </main>

    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('.tab');
            const sections = document.querySelectorAll('.content-section');
            let performanceChartInstance = null;
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const target = tab.dataset.tab;

                    tabs.forEach(t => {
                        t.classList.remove('tab-active');
                        t.classList.add('tab-inactive');
                    });

                    tab.classList.add('tab-active');
                    tab.classList.remove('tab-inactive');

                    sections.forEach(section => {
                        if (section.id === target) {
                            section.classList.remove('hidden');
                            // Re-apply animation class to trigger it
                            section.style.animation = 'none';
                            section.offsetHeight; /* trigger reflow */
                            section.style.animation = null;
                        } else {
                            section.classList.add('hidden');
                        }
                    });

                    if (target === 'alternativas' && !performanceChartInstance) {
                        renderPerformanceChart();
                    }
                });
            });

            function renderPerformanceChart() {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                performanceChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['BUSCARV', 'ÍNDICE + COINCIDIR', 'BUSCARX'],
                        datasets: [{
                            label: 'Tiempo de Cálculo Relativo',
                            data: [100, 75, 60],
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.6)',
                                'rgba(245, 158, 11, 0.6)',
                                'rgba(16, 185, 129, 0.6)'
                            ],
                            borderColor: [
                                'rgba(239, 68, 68, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(16, 185, 129, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return ` Rendimiento: ${context.raw}% del tiempo de BUSCARV`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Tiempo relativo (%)'
                                }
                            }
                        }
                    }
                });
            }

            const cruceData = {
                'EMP-01': 'Ana Torres',
                'EMP-02': 'Luis Gómez',
                'EMP-03': 'Carla Díaz'
            };
            const cruceSelector = document.getElementById('cruce-selector');
            const empleadosTbody = document.getElementById('tabla-empleados-body');

            function updateCruceDemo() {
                const selectedId = cruceSelector.value;

                // Update text result
                document.getElementById('cruce-resultado').textContent = cruceData[selectedId];
                document.getElementById('cruce-formula').textContent = `=BUSCARV("${selectedId}", [Tabla Empleados], 2, FALSO)`;

                // Update table highlighting
                if (empleadosTbody) {
                    // Remove highlight from all rows
                    empleadosTbody.querySelectorAll('tr').forEach(row => {
                        row.classList.remove('highlight-row');
                    });
                    // Add highlight to the selected row
                    const targetRow = document.getElementById(`emp-row-${selectedId}`);
                    if (targetRow) {
                        targetRow.classList.add('highlight-row');
                    }
                }
            }
            cruceSelector.addEventListener('change', updateCruceDemo);
            // Initial call to set the state
            updateCruceDemo();

            const facturaData = {
                'CLI-101': { nombre: 'Global Corp', dir: 'Av. Principal 123', tel: '555-1234' },
                'CLI-102': { nombre: 'Innova S.A.', dir: 'Calle Falsa 456', tel: '555-5678' },
                'CLI-103': { nombre: 'Mercadeo Veloz', dir: 'Paseo del Sol 789', tel: '555-9012' }
            };
            const facturaSelector = document.getElementById('factura-selector');
            facturaSelector.addEventListener('change', (e) => {
                const selectedId = e.target.value;
                const data = facturaData[selectedId];
                document.getElementById('factura-nombre').textContent = data.nombre;
                document.getElementById('factura-direccion').textContent = data.dir;
                document.getElementById('factura-telefono').textContent = data.tel;
            });
            
            const potMatchData = {
                'A-001': { Producto: 'Laptop', Precio: '$1200', Stock: '50' },
                'A-002': { Producto: 'Monitor', Precio: '$300', Stock: '120' },
                'A-003': { Producto: 'Teclado', Precio: '$75', Stock: '200' }
            };
            const skuSelector = document.getElementById('pot-sku-selector');
            const colSelector = document.getElementById('pot-col-selector');
            function updateMatchDemo() {
                const sku = skuSelector.value;
                const col = colSelector.value;
                document.getElementById('pot-match-resultado').textContent = potMatchData[sku][col];
                document.getElementById('pot-match-formula').textContent = `=BUSCARV("${sku}", A2:D4, COINCIDIR("${col}", A1:D1, 0), FALSO)`;
            }
            skuSelector.addEventListener('change', updateMatchDemo);
            colSelector.addEventListener('change', updateMatchDemo);

            const errorInput = document.getElementById('pot-error-input');
            errorInput.addEventListener('input', (e) => {
                const sku = e.target.value;
                const result = potMatchData[sku] ? potMatchData[sku].Stock : 'Producto no encontrado';
                const formula = `=SI.ERROR(BUSCARV("${sku}", A2:D4, 4, FALSO), "Producto no encontrado")`;
                document.getElementById('pot-error-resultado').textContent = result;
                document.getElementById('pot-error-formula').textContent = formula;
                document.getElementById('pot-error-resultado').classList.toggle('text-rose-600', result === 'Producto no encontrado');
                document.getElementById('pot-error-resultado').classList.toggle('text-emerald-600', result !== 'Producto no encontrado');
            });

        });
    </script>
</body>
</html>