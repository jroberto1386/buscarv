<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gu√≠a Interactiva de BUSCARV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: Se ha dise√±ado una aplicaci√≥n de p√°gina √∫nica con navegaci√≥n por pesta√±as (Inicio, Fundamentos, Aplicaciones, Potenciando, Alternativas). Esta estructura segmenta la informaci√≥n compleja en bloques manejables, permitiendo al usuario explorar de forma no lineal. En lugar de leer pasivamente, el usuario interact√∫a con simulaciones de hojas de c√°lculo, selectores din√°micos y visualizaciones de datos. El objetivo es facilitar el aprendizaje pr√°ctico y la retenci√≥n, transformando un informe denso en una herramienta de aprendizaje atractiva y eficiente. La navegaci√≥n es intuitiva y el flujo gu√≠a al usuario desde lo b√°sico hasta lo m√°s avanzado de forma natural. -->
    <!-- Visualization & Content Choices: 
        1. Fundamentos -> Sintaxis Interactiva (HTML/CSS/JS): Se usa para desglosar la f√≥rmula. El objetivo es informar. Al pasar el cursor, el usuario obtiene explicaciones de cada argumento. Es m√°s efectivo que un bloque de texto est√°tico.
        2. Aplicaciones -> Simuladores de Tablas (HTML/JS): Se utilizan para mostrar casos de uso pr√°cticos. El objetivo es organizar y demostrar. El usuario selecciona un ID y ve c√≥mo BUSCARV rellena datos, imitando la experiencia real en Excel para un aprendizaje m√°s profundo.
        3. Potenciando BUSCARV -> Demostraciones Din√°micas (HTML/JS): Para ilustrar la sinergia con otras funciones. El objetivo es demostrar relaciones. Por ejemplo, en la demo de BUSCARV+COINCIDIR, el usuario puede cambiar tanto la fila como la columna a buscar, viendo la f√≥rmula actualizarse en tiempo real.
        4. Alternativas -> Gr√°fico de Barras Comparativo (Chart.js/Canvas): Para comparar el rendimiento. El objetivo es comparar. Un gr√°fico de barras visualiza la diferencia de eficiencia entre BUSCARV, √çNDICE+COINCIDIR y BUSCARX de manera m√°s impactante que el texto solo, justificando el cambio a funciones m√°s modernas.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4B4B4B;
        }
        .tab-active {
            border-bottom-color: #D97706;
            color: #D97706;
            font-weight: 600;
        }
        .tab-inactive {
            border-bottom-color: transparent;
            color: #78716C;
        }
        .formula-arg {
            cursor: pointer;
            position: relative;
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .formula-arg .tooltip-text {
            visibility: hidden;
            width: 280px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.875rem;
            line-height: 1.4;
        }
        .formula-arg:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .table-cell {
            padding: 8px 12px;
            border: 1px solid #E7E5E4;
            text-align: left;
            font-size: 0.875rem;
        }
        .table-header {
            background-color: #F5F5F4;
            font-weight: 600;
        }
        .interactive-table select, .interactive-table input {
            border: 1px solid #D6D3D1;
            border-radius: 4px;
            padding: 4px 8px;
            width: 100%;
        }
        .code-block {
            background-color: #1E293B;
            color: #E2E8F0;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }
    </style>
</head>
<body class="antialiased">

    <div class="min-h-screen">
        <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <h1 class="text-2xl font-bold text-amber-700">Gu√≠a Maestra de BUSCARV</h1>
                    <nav class="hidden md:flex space-x-6">
                        <button data-tab="inicio" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-active">Inicio</button>
                        <button data-tab="fundamentos" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Fundamentos</button>
                        <button data-tab="aplicaciones" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Aplicaciones</button>
                        <button data-tab="potenciando" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Potenciando</button>
                        <button data-tab="alternativas" class="tab text-sm font-medium border-b-2 transition-colors duration-200 tab-inactive">Alternativas</button>
                    </nav>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
            
            <section id="inicio" class="content-section">
                <div class="text-center bg-amber-50 border border-amber-200 rounded-lg p-8">
                    <h2 class="text-3xl font-bold text-amber-800 mb-3">Domina la Funci√≥n Clave de B√∫squeda de Excel</h2>
                    <p class="text-lg text-stone-700 max-w-3xl mx-auto">
                        Bienvenido a esta gu√≠a interactiva sobre BUSCARV (VLOOKUP). Aqu√≠ desmitificaremos una de las funciones m√°s potentes y utilizadas de Excel. Aprender√°s desde su sintaxis b√°sica hasta c√≥mo combinarla con otras f√≥rmulas para resolver problemas complejos, y descubrir√°s por qu√© sus sucesores, como BUSCARX, est√°n cambiando el juego.
                    </p>
                </div>

                <div class="mt-12 grid md:grid-cols-3 gap-8 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <div class="text-3xl mb-3">üîé</div>
                        <h3 class="text-xl font-semibold text-stone-800 mb-2">¬øQu√© es BUSCARV?</h3>
                        <p class="text-stone-600">Es una funci√≥n de b√∫squeda vertical que te permite encontrar un valor espec√≠fico en la primera columna de una tabla y devolver un dato correspondiente de otra columna en la misma fila.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                         <div class="text-3xl mb-3">‚öôÔ∏è</div>
                        <h3 class="text-xl font-semibold text-stone-800 mb-2">¬øPor qu√© es importante?</h3>
                        <p class="text-stone-600">Es la herramienta fundamental para cruzar y consolidar informaci√≥n entre distintas tablas, una tarea esencial en cualquier an√°lisis de datos, desde finanzas hasta log√≠stica.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                         <div class="text-3xl mb-3">üöÄ</div>
                        <h3 class="text-xl font-semibold text-stone-800 mb-2">¬øQu√© aprender√°s aqu√≠?</h3>
                        <p class="text-stone-600">No solo a usar BUSCARV, sino a entender su l√≥gica, sus limitaciones y c√≥mo las funciones modernas como BUSCARX superan sus debilidades, prepar√°ndote para el futuro de Excel.</p>
                    </div>
                </div>
            </section>

            <section id="fundamentos" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Fundamentos de BUSCARV</h2>
                <p class="text-lg text-stone-600 mb-8">Para dominar BUSCARV, primero debemos entender sus cuatro componentes esenciales. Interact√∫a con la f√≥rmula a continuaci√≥n para ver qu√© hace cada argumento.</p>
                
                <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 mb-8">
                    <h3 class="text-xl font-semibold text-center mb-4">Sintaxis Interactiva</h3>
                    <div class="code-block text-center text-lg">
                        =BUSCARV(<span class="formula-arg bg-sky-200 text-sky-800">valor_buscado<span class="tooltip-text"><b>¬øQu√© quieres buscar?</b> Es el valor (ej. ID de producto "PROD-002") que sirve como identificador √∫nico. Debe estar en la primera columna de tu tabla de datos.</span></span>, <span class="formula-arg bg-emerald-200 text-emerald-800">matriz_tabla<span class="tooltip-text"><b>¬øD√≥nde quieres buscar?</b> Es el rango de celdas (ej. A2:D100) que contiene los datos. La primera columna DEBE ser la que contiene el 'valor_buscado'.</span></span>, <span class="formula-arg bg-purple-200 text-purple-800">indicador_columnas<span class="tooltip-text"><b>¬øQu√© columna quieres devolver?</b> Es el n√∫mero de la columna dentro de tu 'matriz_tabla' de la cual quieres obtener el resultado. La primera columna es 1, la segunda 2, etc.</span></span>, <span class="formula-arg bg-rose-200 text-rose-800">rango<span class="tooltip-text"><b>¬øB√∫squeda exacta o aproximada?</b> Usa FALSO (o 0) para una coincidencia exacta (lo m√°s com√∫n y seguro). Usa VERDADERO (o 1) para una coincidencia aproximada (√∫til para rangos, como escalas de comisiones).</span></span>)
                    </div>
                </div>

                <h3 class="text-2xl font-semibold text-stone-800 mb-4">B√∫squeda Exacta vs. Aproximada</h3>
                <p class="text-stone-600 mb-6">La elecci√≥n del cuarto argumento, `rango`, es crucial y cambia completamente el comportamiento de la funci√≥n. La b√∫squeda exacta (FALSO) es la opci√≥n predeterminada para el 95% de los casos.</p>

                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <h4 class="text-xl font-semibold text-rose-700 mb-3">B√∫squeda Exacta (FALSO / 0)</h4>
                        <p class="mb-4">Busca una coincidencia id√©ntica del `valor_buscado`. Si no la encuentra, devuelve un error #N/A. Es la opci√≥n ideal para buscar IDs, c√≥digos de producto, DNI, etc., donde no hay lugar para ambig√ºedad.</p>
                        <p class="font-semibold mb-2">Ejemplo: Buscar el precio de un producto espec√≠fico.</p>
                        <table class="w-full border-collapse">
                            <thead><tr><th class="table-cell table-header">ID_Producto</th><th class="table-cell table-header">Precio</th></tr></thead>
                            <tbody>
                                <tr><td class="table-cell">PROD-001</td><td class="table-cell">$150</td></tr>
                                <tr><td class="table-cell bg-sky-100">PROD-002</td><td class="table-cell bg-emerald-100">$200</td></tr>
                                <tr><td class="table-cell">PROD-003</td><td class="table-cell">$250</td></tr>
                            </tbody>
                        </table>
                        <div class="code-block mt-4 text-sm">=BUSCARV("PROD-002", A2:B4, 2, FALSO)
                        <br><span class="text-emerald-400 font-bold">--> Devuelve: $200</span></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <h4 class="text-xl font-semibold text-teal-700 mb-3">B√∫squeda Aproximada (VERDADERO / 1)</h4>
                        <p class="mb-4">Busca la coincidencia m√°s cercana que sea menor o igual al `valor_buscado`. <strong>¬°Cr√≠tico!</strong> La primera columna de la tabla debe estar ordenada de forma ascendente.</p>
                        <p class="font-semibold mb-2">Ejemplo: Asignar una comisi√≥n seg√∫n el volumen de ventas.</p>
                         <table class="w-full border-collapse">
                            <thead><tr><th class="table-cell table-header">Ventas M√≠nimas</th><th class="table-cell table-header">Comisi√≥n</th></tr></thead>
                            <tbody>
                                <tr><td class="table-cell">$0</td><td class="table-cell">1%</td></tr>
                                <tr><td class="table-cell bg-sky-100">$5,000</td><td class="table-cell bg-emerald-100">3%</td></tr>
                                <tr><td class="table-cell">$10,000</td><td class="table-cell">5%</td></tr>
                            </tbody>
                        </table>
                        <div class="code-block mt-4 text-sm">=BUSCARV(7800, A2:B4, 2, VERDADERO)
                        <br><span class="text-emerald-400 font-bold">--> Devuelve: 3% (porque 7800 es mayor que 5000 pero menor que 10000)</span></div>
                    </div>
                </div>
            </section>

            <section id="aplicaciones" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Aplicaciones Pr√°cticas</h2>
                <p class="text-lg text-stone-600 mb-8">BUSCARV es una navaja suiza. Aqu√≠ te mostramos sus usos m√°s comunes a trav√©s de ejemplos interactivos. Selecciona un valor para ver la magia.</p>
                
                <div class="space-y-8">
                    <!-- Cruce de Datos -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">1. Cruzar y Combinar Datos de Tablas</h3>
                        <p class="mb-4">El uso m√°s cl√°sico: tienes una tabla de ventas con ID de Empleado, pero necesitas traer el nombre del empleado desde otra tabla.</p>
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h4 class="font-semibold mb-2">Tabla de Ventas</h4>
                                <table class="w-full border-collapse">
                                    <thead><tr><th class="table-cell table-header">ID_Venta</th><th class="table-cell table-header">ID_Empleado</th><th class="table-cell table-header">Monto</th></tr></thead>
                                    <tbody>
                                        <tr><td class="table-cell">101</td><td class="table-cell">EMP-02</td><td class="table-cell">$500</td></tr>
                                        <tr><td class="table-cell">102</td><td class="table-cell">EMP-03</td><td class="table-cell">$1200</td></tr>
                                        <tr><td class="table-cell">103</td><td class="table-cell">EMP-01</td><td class="table-cell">$850</td></tr>
                                    </tbody>
                                </table>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">Tabla de Empleados (Matriz de B√∫squeda)</h4>
                                <table class="w-full border-collapse">
                                    <thead><tr><th class="table-cell table-header">ID_Empleado</th><th class="table-cell table-header">Nombre</th></tr></thead>
                                    <tbody>
                                        <tr><td class="table-cell">EMP-01</td><td class="table-cell">Ana Torres</td></tr>
                                        <tr><td class="table-cell">EMP-02</td><td class="table-cell">Luis G√≥mez</td></tr>
                                        <tr><td class="table-cell">EMP-03</td><td class="table-cell">Carla D√≠az</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="mt-6 p-4 bg-stone-50 rounded-md border">
                            <h4 class="font-semibold mb-2">Simulador Interactivo</h4>
                            <label for="cruce-selector" class="block text-sm font-medium text-stone-700">Selecciona un ID de Empleado de la tabla de ventas:</label>
                            <select id="cruce-selector" class="mt-1">
                                <option value="EMP-02">EMP-02</option>
                                <option value="EMP-03">EMP-03</option>
                                <option value="EMP-01">EMP-01</option>
                            </select>
                            <div class="mt-4">
                                <p><strong>Nombre del Empleado:</strong> <span id="cruce-resultado" class="font-bold text-lg text-emerald-600">Luis G√≥mez</span></p>
                                <div class="code-block mt-2 text-sm" id="cruce-formula">=BUSCARV("EMP-02", [Tabla Empleados], 2, FALSO)</div>
                            </div>
                        </div>
                    </div>

                    <!-- Rellenar Plantillas -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">2. Rellenar Formularios y Plantillas Din√°micas</h3>
                        <p class="mb-4">Crea plantillas de facturas o informes que se autocompletan. Al introducir un ID de Cliente, BUSCARV rellena el resto de los datos.</p>
                         <div class="grid md:grid-cols-2 gap-8 items-start">
                             <div>
                                <h4 class="font-semibold mb-2">Factura (Plantilla)</h4>
                                <div class="p-4 border rounded-md">
                                    <label for="factura-selector">ID Cliente:</label>
                                    <select id="factura-selector" class="mt-1 w-full">
                                        <option value="CLI-101">CLI-101</option>
                                        <option value="CLI-102">CLI-102</option>
                                        <option value="CLI-103">CLI-103</option>
                                    </select>
                                    <p class="mt-2"><strong>Nombre:</strong> <span id="factura-nombre" class="font-semibold">Global Corp</span></p>
                                    <p class="mt-1"><strong>Direcci√≥n:</strong> <span id="factura-direccion" class="font-semibold">Av. Principal 123</span></p>
                                    <p class="mt-1"><strong>Tel√©fono:</strong> <span id="factura-telefono" class="font-semibold">555-1234</span></p>
                                </div>
                            </div>
                             <div>
                                <h4 class="font-semibold mb-2">Base de Datos de Clientes</h4>
                                <table class="w-full border-collapse">
                                    <thead><tr><th class="table-cell table-header">ID</th><th class="table-cell table-header">Nombre</th><th class="table-cell table-header">Direcci√≥n</th><th class="table-cell table-header">Tel√©fono</th></tr></thead>
                                    <tbody>
                                        <tr><td class="table-cell">CLI-101</td><td class="table-cell">Global Corp</td><td class="table-cell">Av. Principal 123</td><td class="table-cell">555-1234</td></tr>
                                        <tr><td class="table-cell">CLI-102</td><td class="table-cell">Innova S.A.</td><td class="table-cell">Calle Falsa 456</td><td class="table-cell">555-5678</td></tr>
                                        <tr><td class="table-cell">CLI-103</td><td class="table-cell">Mercadeo Veloz</td><td class="table-cell">Paseo del Sol 789</td><td class="table-cell">555-9012</td></tr>
                                    </tbody>
                                </table>
                             </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="potenciando" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Potenciando a BUSCARV</h2>
                <p class="text-lg text-stone-600 mb-8">BUSCARV brilla de verdad cuando se combina con otras funciones. Estas sinergias resuelven sus debilidades y lo hacen mucho m√°s robusto.</p>

                <div class="space-y-8">
                    <!-- BUSCARV + COINCIDIR -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">BUSCARV + COINCIDIR: La B√∫squeda Din√°mica</h3>
                        <p class="mb-4">Esta es la combinaci√≥n estrella. Anidamos `COINCIDIR` en el `indicador_columnas` para que el n√∫mero de columna se calcule autom√°ticamente seg√∫n su encabezado. Tu f√≥rmula ya no se romper√° si insertas o reordenas columnas.</p>
                        
                        <h4 class="font-semibold mb-2">Tabla de Datos de Productos</h4>
                        <table class="w-full border-collapse" id="pot-match-table">
                            <thead><tr><th class="table-cell table-header">SKU</th><th class="table-cell table-header">Producto</th><th class="table-cell table-header">Precio</th><th class="table-cell table-header">Stock</th></tr></thead>
                            <tbody>
                                <tr><td class="table-cell">A-001</td><td class="table-cell">Laptop</td><td class="table-cell">$1200</td><td class="table-cell">50</td></tr>
                                <tr><td class="table-cell">A-002</td><td class="table-cell">Monitor</td><td class="table-cell">$300</td><td class="table-cell">120</td></tr>
                                <tr><td class="table-cell">A-003</td><td class="table-cell">Teclado</td><td class="table-cell">$75</td><td class="table-cell">200</td></tr>
                            </tbody>
                        </table>

                        <div class="mt-6 p-4 bg-stone-50 rounded-md border grid md:grid-cols-2 gap-4">
                            <div>
                                <label for="pot-sku-selector" class="block text-sm font-medium">Buscar SKU:</label>
                                <select id="pot-sku-selector" class="mt-1">
                                    <option value="A-001">A-001</option>
                                    <option value="A-002" selected>A-002</option>
                                    <option value="A-003">A-003</option>
                                </select>
                            </div>
                            <div>
                                <label for="pot-col-selector" class="block text-sm font-medium">Obtener dato de la columna:</label>
                                <select id="pot-col-selector" class="mt-1">
                                    <option value="Producto">Producto</option>
                                    <option value="Precio">Precio</option>
                                    <option value="Stock" selected>Stock</option>
                                </select>
                            </div>
                        </div>
                         <div class="mt-4">
                            <p><strong>Resultado:</strong> <span id="pot-match-resultado" class="font-bold text-lg text-emerald-600">120</span></p>
                            <div class="code-block mt-2 text-sm" id="pot-match-formula">=BUSCARV("A-002", A2:D4, COINCIDIR("Stock", A1:D1, 0), FALSO)</div>
                        </div>
                    </div>
                    <!-- BUSCARV + SI.ERROR -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200 interactive-table">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">BUSCARV + SI.ERROR: Manejo Profesional de Errores</h3>
                        <p class="mb-4">Cuando BUSCARV no encuentra un valor, devuelve el antiest√©tico error #N/A. Envolvemos la f√≥rmula con `SI.ERROR` para reemplazarlo por un mensaje personalizado, como "No Encontrado", 0, o una celda en blanco.</p>

                        <div class="mt-6 p-4 bg-stone-50 rounded-md border">
                            <label for="pot-error-input" class="block text-sm font-medium">Introduce un SKU para buscar (prueba con "A-001" o "A-999"):</label>
                            <input type="text" id="pot-error-input" value="A-999" class="mt-1">
                            
                            <div class="mt-4">
                                <p><strong>Stock del producto:</strong> <span id="pot-error-resultado" class="font-bold text-lg text-rose-600">Producto no encontrado</span></p>
                                <div class="code-block mt-2 text-sm" id="pot-error-formula">=SI.ERROR(BUSCARV("A-999", A2:D4, 4, FALSO), "Producto no encontrado")</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="alternativas" class="content-section hidden">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Limitaciones y Alternativas Modernas</h2>
                <p class="text-lg text-stone-600 mb-8">A pesar de su utilidad, BUSCARV tiene debilidades importantes. Conoce por qu√© los expertos prefieren alternativas m√°s flexibles y potentes como √çNDICE+COINCIDIR y el revolucionario BUSCARX.</p>

                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                        <h3 class="text-xl font-semibold text-stone-800 mb-4">Debilidades Clave de BUSCARV</h3>
                        <ul class="space-y-3 list-disc list-inside text-stone-700">
                            <li>
                                <strong class="text-rose-700">No busca a la izquierda:</strong> Solo puede buscar en la primera columna de la tabla y devolver un valor de una columna a su derecha. Un gran limitante.
                            </li>
                            <li>
                                <strong class="text-rose-700">Es fr√°gil:</strong> Si no se usa con `COINCIDIR`, la f√≥rmula se rompe si se insertan o eliminan columnas en la tabla de origen, ya que el √≠ndice de columna se vuelve incorrecto.
                            </li>
                            <li>
                                <strong class="text-rose-700">Rendimiento:</strong> En tablas con cientos de miles de filas, puede volverse lento, ya que eval√∫a la tabla completa en memoria.
                            </li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                         <h3 class="text-xl font-semibold text-stone-800 mb-4">Comparativa de Rendimiento</h3>
                         <p class="text-sm text-stone-600 mb-4">Este gr√°fico ilustra el tiempo de c√°lculo relativo en un gran conjunto de datos. Menor es mejor.</p>
                         <div class="chart-container" style="position: relative; height:200px; width:100%">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="mt-10 bg-white p-6 rounded-lg shadow-sm border border-stone-200">
                    <h3 class="text-2xl font-semibold text-center text-stone-800 mb-6">Tabla Comparativa de Funciones de B√∫squeda</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full min-w-[600px] border-collapse">
                            <thead>
                                <tr>
                                    <th class="table-cell table-header">Caracter√≠stica</th>
                                    <th class="table-cell table-header text-center">BUSCARV</th>
                                    <th class="table-cell table-header text-center bg-amber-100">√çNDICE + COINCIDIR</th>
                                    <th class="table-cell table-header text-center bg-emerald-100">BUSCARX</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="table-cell font-semibold">Busca a la izquierda</td>
                                    <td class="table-cell text-center text-2xl">‚ùå</td>
                                    <td class="table-cell text-center text-2xl bg-amber-50">‚úÖ</td>
                                    <td class="table-cell text-center text-2xl bg-emerald-50">‚úÖ</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Robusto ante cambios de columnas</td>
                                    <td class="table-cell text-center text-2xl">‚ö†Ô∏è (Solo con COINCIDIR)</td>
                                    <td class="table-cell text-center text-2xl bg-amber-50">‚úÖ</td>
                                    <td class="table-cell text-center text-2xl bg-emerald-50">‚úÖ</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Manejo de errores nativo</td>
                                    <td class="table-cell text-center text-2xl">‚ùå (Requiere SI.ERROR)</td>
                                    <td class="table-cell text-center text-2xl bg-amber-50">‚ùå (Requiere SI.ERROR)</td>
                                    <td class="table-cell text-center text-2xl bg-emerald-50">‚úÖ</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">B√∫squeda inversa (de abajo hacia arriba)</td>
                                    <td class="table-cell text-center text-2xl">‚ùå</td>
                                    <td class="table-cell text-center text-2xl bg-amber-50">‚ùå</td>
                                    <td class="table-cell text-center text-2xl bg-emerald-50">‚úÖ</td>
                                </tr>
                                <tr>
                                    <td class="table-cell font-semibold">Facilidad de uso / Sintaxis</td>
                                    <td class="table-cell text-center">Moderada</td>
                                    <td class="table-cell text-center bg-amber-50">Compleja (dos funciones)</td>
                                    <td class="table-cell text-center bg-emerald-50">Sencilla y potente</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-6 p-4 bg-emerald-50 border border-emerald-200 rounded-md text-center">
                        <p class="font-semibold text-emerald-800">Conclusi√≥n: Si tu versi√≥n de Excel lo soporta (Microsoft 365, Excel 2021), <strong class="text-xl">BUSCARX es la opci√≥n superior en todos los aspectos.</strong> Es m√°s potente, m√°s flexible y m√°s f√°cil de escribir que BUSCARV y √çNDICE+COINCIDIR.</p>
                    </div>
                </div>

            </section>
        </main>

    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('.tab');
            const sections = document.querySelectorAll('.content-section');
            let performanceChartInstance = null;
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const target = tab.dataset.tab;

                    tabs.forEach(t => {
                        t.classList.remove('tab-active');
                        t.classList.add('tab-inactive');
                    });

                    tab.classList.add('tab-active');
                    tab.classList.remove('tab-inactive');

                    sections.forEach(section => {
                        if (section.id === target) {
                            section.classList.remove('hidden');
                        } else {
                            section.classList.add('hidden');
                        }
                    });

                    if (target === 'alternativas' && !performanceChartInstance) {
                        renderPerformanceChart();
                    }
                });
            });

            function renderPerformanceChart() {
                const ctx = document.getElementById('performanceChart').getContext('2d');
                performanceChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['BUSCARV', '√çNDICE + COINCIDIR', 'BUSCARX'],
                        datasets: [{
                            label: 'Tiempo de C√°lculo Relativo',
                            data: [100, 75, 60],
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.6)',
                                'rgba(245, 158, 11, 0.6)',
                                'rgba(16, 185, 129, 0.6)'
                            ],
                            borderColor: [
                                'rgba(239, 68, 68, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(16, 185, 129, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return ` Rendimiento: ${context.raw}% del tiempo de BUSCARV`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Tiempo relativo (%)'
                                }
                            }
                        }
                    }
                });
            }

            const cruceData = {
                'EMP-01': 'Ana Torres',
                'EMP-02': 'Luis G√≥mez',
                'EMP-03': 'Carla D√≠az'
            };
            const cruceSelector = document.getElementById('cruce-selector');
            cruceSelector.addEventListener('change', (e) => {
                const selectedId = e.target.value;
                document.getElementById('cruce-resultado').textContent = cruceData[selectedId];
                document.getElementById('cruce-formula').textContent = `=BUSCARV("${selectedId}", [Tabla Empleados], 2, FALSO)`;
            });

            const facturaData = {
                'CLI-101': { nombre: 'Global Corp', dir: 'Av. Principal 123', tel: '555-1234' },
                'CLI-102': { nombre: 'Innova S.A.', dir: 'Calle Falsa 456', tel: '555-5678' },
                'CLI-103': { nombre: 'Mercadeo Veloz', dir: 'Paseo del Sol 789', tel: '555-9012' }
            };
            const facturaSelector = document.getElementById('factura-selector');
            facturaSelector.addEventListener('change', (e) => {
                const selectedId = e.target.value;
                const data = facturaData[selectedId];
                document.getElementById('factura-nombre').textContent = data.nombre;
                document.getElementById('factura-direccion').textContent = data.dir;
                document.getElementById('factura-telefono').textContent = data.tel;
            });
            
            const potMatchData = {
                'A-001': { Producto: 'Laptop', Precio: '$1200', Stock: '50' },
                'A-002': { Producto: 'Monitor', Precio: '$300', Stock: '120' },
                'A-003': { Producto: 'Teclado', Precio: '$75', Stock: '200' }
            };
            const skuSelector = document.getElementById('pot-sku-selector');
            const colSelector = document.getElementById('pot-col-selector');
            function updateMatchDemo() {
                const sku = skuSelector.value;
                const col = colSelector.value;
                document.getElementById('pot-match-resultado').textContent = potMatchData[sku][col];
                document.getElementById('pot-match-formula').textContent = `=BUSCARV("${sku}", A2:D4, COINCIDIR("${col}", A1:D1, 0), FALSO)`;
            }
            skuSelector.addEventListener('change', updateMatchDemo);
            colSelector.addEventListener('change', updateMatchDemo);

            const errorInput = document.getElementById('pot-error-input');
            errorInput.addEventListener('input', (e) => {
                const sku = e.target.value;
                const result = potMatchData[sku] ? potMatchData[sku].Stock : 'Producto no encontrado';
                const formula = `=SI.ERROR(BUSCARV("${sku}", A2:D4, 4, FALSO), "Producto no encontrado")`;
                document.getElementById('pot-error-resultado').textContent = result;
                document.getElementById('pot-error-formula').textContent = formula;
                document.getElementById('pot-error-resultado').classList.toggle('text-rose-600', result === 'Producto no encontrado');
                document.getElementById('pot-error-resultado').classList.toggle('text-emerald-600', result !== 'Producto no encontrado');
            });

        });
    </script>
</body>
</html>